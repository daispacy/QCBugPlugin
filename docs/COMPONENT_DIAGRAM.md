# QCBugPlugin - Component Architecture Diagram

## System Architecture (High Level)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        HOST APPLICATION                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ AppDelegate / SceneDelegate                                  â”‚ â”‚
â”‚  â”‚  - Initialize QCBugPlugin.configure(using:configuration:)    â”‚ â”‚
â”‚  â”‚  - Set QCBugPlugin.setDelegate(_:)                          â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                         â”‚                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚            QCBugPlugin (Public Static API)                  â”‚ â”‚
â”‚  â”‚  - presentBugReport()                                       â”‚ â”‚
â”‚  â”‚  - startScreenRecording/stopScreenRecording()               â”‚ â”‚
â”‚  â”‚  - setCustomData(), setScreenRecordingEnabled()             â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                         â”‚                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚                        â”‚
         FRAMEWORK CODE BOUNDARY       â”‚
              â”‚                        â”‚
        â”Œâ”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                       â”‚                 â”‚
        â–¼                       â–¼                 â–¼
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚   Manager    â”‚      â”‚ Presentation â”‚    â”‚    Data      â”‚
  â”‚   Layer      â”‚      â”‚    Layer     â”‚    â”‚    Layer     â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Detailed Component Interaction Map

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                                                                             â•‘
â•‘                    PRESENTATION LAYER (UI Components)                      â•‘
â•‘                                                                             â•‘
â•‘  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â•‘
â•‘  â”‚                                                                      â”‚ â•‘
â•‘  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚ â•‘
â•‘  â”‚  â”‚  QCFloatingActionButtons    â”‚       â”‚  QCBugReportViewController  â”‚  â”‚ â•‘
â•‘  â”‚  â”‚  - Main ğŸ› button          â”‚       â”‚  - Form (WebView)         â”‚  â”‚ â•‘
â•‘  â”‚  â”‚  - Record/Screenshot/Form  â”‚â”€â”€â”€â”   â”‚  - Media display          â”‚  â”‚ â•‘
â•‘  â”‚  â”‚  - Clear session           â”‚   â”‚   â”‚  - GitLab auth injection  â”‚  â”‚ â•‘
â•‘  â”‚  â”‚  - Pan/snap to edge        â”‚   â”‚   â”‚  - State restoration      â”‚  â”‚ â•‘
â•‘  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ â•‘
â•‘  â”‚         implements              â”‚              implements             â”‚ â•‘
â•‘  â”‚  QCFloatingActionButtonsDelegateâ”‚ QCBugReportViewControllerDelegate  â”‚ â•‘
â•‘  â”‚                                â”‚                                     â”‚ â•‘
â•‘  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚ â•‘
â•‘  â”‚  â”‚                                                              â”‚   â”‚ â•‘
â•‘  â”‚  â”‚  QCScreenshotAnnotationViewController                       â”‚   â”‚ â•‘
â•‘  â”‚  â”‚  - Draw on screenshot                                      â”‚   â”‚ â•‘
â•‘  â”‚  â”‚  - Save annotated image                                    â”‚   â”‚ â•‘
â•‘  â”‚  â”‚                                                              â”‚   â”‚ â•‘
â•‘  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚ â•‘
â•‘  â”‚                                                                      â”‚ â•‘
â•‘  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â•‘
â•‘                          â–²                                                 â•‘
â•‘                          â”‚                                                 â•‘
â•‘                    delegates to                                           â•‘
â•‘                          â”‚                                                 â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                           â”‚
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                          â”‚                                                â•‘
â•‘         MANAGER LAYER (QCBugPluginManager - Singleton)                   â•‘
â•‘                                                                           â•‘
â•‘   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â•‘
â•‘   â”‚                                                                  â”‚   â•‘
â•‘   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â•‘
â•‘   â”‚  â”‚  Service Initialization & Configuration                   â”‚ â”‚   â•‘
â•‘   â”‚  â”‚  - screenRecorder: ScreenRecordingProtocol?              â”‚ â”‚   â•‘
â•‘   â”‚  â”‚  - screenCapture: ScreenCaptureProtocol?                â”‚ â”‚   â•‘
â•‘   â”‚  â”‚  - bugReportService: BugReportProtocol?                 â”‚ â”‚   â•‘
â•‘   â”‚  â”‚  - gitLabAuthService: GitLabAuthProviding?              â”‚ â”‚   â•‘
â•‘   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚   â•‘
â•‘   â”‚                                                                  â”‚   â•‘
â•‘   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â•‘
â•‘   â”‚  â”‚  Session State Management                                 â”‚ â”‚   â•‘
â•‘   â”‚  â”‚  - sessionMediaAttachments: [MediaAttachment]            â”‚ â”‚   â•‘
â•‘   â”‚  â”‚  - sessionBugReportViewController: ?                     â”‚ â”‚   â•‘
â•‘   â”‚  â”‚  - sessionBugDescription, Priority, Category             â”‚ â”‚   â•‘
â•‘   â”‚  â”‚  - sessionWebhookURL, AssigneeUsername, IssueNumber      â”‚ â”‚   â•‘
â•‘   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚   â•‘
â•‘   â”‚                                                                  â”‚   â•‘
â•‘   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â•‘
â•‘   â”‚  â”‚  Lifecycle Management                                     â”‚ â”‚   â•‘
â•‘   â”‚  â”‚  - configure(using:configuration:)                       â”‚ â”‚   â•‘
â•‘   â”‚  â”‚  - presentBugReport()                                    â”‚ â”‚   â•‘
â•‘   â”‚  â”‚  - captureScreenshot(completion:)                        â”‚ â”‚   â•‘
â•‘   â”‚  â”‚  - stopScreenRecording(completion:)                      â”‚ â”‚   â•‘
â•‘   â”‚  â”‚  - clearSession()                                        â”‚ â”‚   â•‘
â•‘   â”‚  â”‚  - invalidateGitLabSession()                             â”‚ â”‚   â•‘
â•‘   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚   â•‘
â•‘   â”‚                                                                  â”‚   â•‘
â•‘   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â•‘
â•‘   â”‚  â”‚  UI Coordination                                          â”‚ â”‚   â•‘
â•‘   â”‚  â”‚  - setupFloatingActionButtons()                          â”‚ â”‚   â•‘
â•‘   â”‚  â”‚  - presentScreenshotAnnotationEditor()                   â”‚ â”‚   â•‘
â•‘   â”‚  â”‚  - presentNativeAttachmentPreview()                      â”‚ â”‚   â•‘
â•‘   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚   â•‘
â•‘   â”‚                                                                  â”‚   â•‘
â•‘   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â•‘
â•‘                                                                           â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•¦â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                            â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚                  â”‚                  â”‚
         â–¼                  â–¼                  â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Domain  â”‚         â”‚  Data   â”‚      â”‚  Config    â”‚
    â”‚ Layer   â”‚         â”‚  Layer  â”‚      â”‚   Layer    â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Data/Service Layer Components

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                        DATA LAYER (Services)                               â•‘
â•‘                                                                             â•‘
â•‘  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â•‘
â•‘  â”‚                                                                     â”‚  â•‘
â•‘  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â•‘
â•‘  â”‚  â”‚  BugReportAPIService (implements BugReportProtocol)         â”‚  â”‚  â•‘
â•‘  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚  â•‘
â•‘  â”‚  â”‚  â”‚  Responsibilities:                                   â”‚ â”‚  â”‚  â•‘
â•‘  â”‚  â”‚  â”‚  1. Build BugReportPayload (JSON)                   â”‚ â”‚  â”‚  â•‘
â•‘  â”‚  â”‚  â”‚  2. Process attachments in parallel                â”‚ â”‚  â”‚  â•‘
â•‘  â”‚  â”‚  â”‚     - Screenshots: JPEG compression                â”‚ â”‚  â”‚  â•‘
â•‘  â”‚  â”‚  â”‚     - Videos: AVAssetExport + cascading presets   â”‚ â”‚  â”‚  â•‘
â•‘  â”‚  â”‚  â”‚  3. Base64 encode + inline in JSON               â”‚ â”‚  â”‚  â•‘
â•‘  â”‚  â”‚  â”‚  4. POST to webhook with auth headers             â”‚ â”‚  â”‚  â•‘
â•‘  â”‚  â”‚  â”‚  5. Handle errors + retries                       â”‚ â”‚  â”‚  â•‘
â•‘  â”‚  â”‚  â”‚                                                    â”‚ â”‚  â”‚  â•‘
â•‘  â”‚  â”‚  â”‚  Key Limits:                                       â”‚ â”‚  â”‚  â•‘
â•‘  â”‚  â”‚  â”‚  - Screenshot: 320 KB max                         â”‚ â”‚  â”‚  â•‘
â•‘  â”‚  â”‚  â”‚  - Video: 5 MB max                                â”‚ â”‚  â”‚  â•‘
â•‘  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚  â•‘
â•‘  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â•‘
â•‘  â”‚                                                                 â”‚  â•‘
â•‘  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â•‘
â•‘  â”‚  â”‚  GitLabAuthService (implements GitLabAuthProviding)    â”‚  â”‚  â•‘
â•‘  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚  â•‘
â•‘  â”‚  â”‚  â”‚  Responsibilities:                               â”‚ â”‚  â”‚  â•‘
â•‘  â”‚  â”‚  â”‚  1. OAuth 2.0 device flow setup                â”‚ â”‚  â”‚  â•‘
â•‘  â”‚  â”‚  â”‚  2. JWT generation (HMAC-SHA256)               â”‚ â”‚  â”‚  â•‘
â•‘  â”‚  â”‚  â”‚  3. Token caching with TTL                     â”‚ â”‚  â”‚  â•‘
â•‘  â”‚  â”‚  â”‚  4. Username resolution from API               â”‚ â”‚  â”‚  â•‘
â•‘  â”‚  â”‚  â”‚  5. Interactive auth (ASWebAuthenticationSession) â”‚ â”‚  â”‚  â•‘
â•‘  â”‚  â”‚  â”‚                                                 â”‚ â”‚  â”‚  â•‘
â•‘  â”‚  â”‚  â”‚  Interacts:                                     â”‚ â”‚  â”‚  â•‘
â•‘  â”‚  â”‚  â”‚  - GitLabSessionStore (token persistence)     â”‚ â”‚  â”‚  â•‘
â•‘  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚  â•‘
â•‘  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â•‘
â•‘  â”‚                                                                 â”‚  â•‘
â•‘  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â•‘
â•‘  â”‚  â”‚  ScreenRecordingService (implements ScreenRecording     â”‚  â”‚  â•‘
â•‘  â”‚  â”‚                          Protocol)                      â”‚  â”‚  â•‘
â•‘  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚  â•‘
â•‘  â”‚  â”‚  â”‚  Responsibilities:                               â”‚ â”‚  â”‚  â•‘
â•‘  â”‚  â”‚  â”‚  1. Wrap ReplayKit framework                   â”‚ â”‚  â”‚  â•‘
â•‘  â”‚  â”‚  â”‚  2. Detect external recordings                 â”‚ â”‚  â”‚  â•‘
â•‘  â”‚  â”‚  â”‚  3. Save to app Caches directory               â”‚ â”‚  â”‚  â•‘
â•‘  â”‚  â”‚  â”‚  4. Auto-cleanup on background                 â”‚ â”‚  â”‚  â•‘
â•‘  â”‚  â”‚  â”‚  5. Request permissions                        â”‚ â”‚  â”‚  â•‘
â•‘  â”‚  â”‚  â”‚                                                 â”‚ â”‚  â”‚  â•‘
â•‘  â”‚  â”‚  â”‚  State:                                         â”‚ â”‚  â”‚  â•‘
â•‘  â”‚  â”‚  â”‚  - isAvailable, isRecording                    â”‚ â”‚  â”‚  â•‘
â•‘  â”‚  â”‚  â”‚  - isRecordingOwnedByService                   â”‚ â”‚  â”‚  â•‘
â•‘  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚  â•‘
â•‘  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â•‘
â•‘  â”‚                                                                 â”‚  â•‘
â•‘  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â•‘
â•‘  â”‚  â”‚  ScreenCaptureService (implements ScreenCapture        â”‚  â”‚  â•‘
â•‘  â”‚  â”‚                        Protocol)                       â”‚  â”‚  â•‘
â•‘  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚  â•‘
â•‘  â”‚  â”‚  â”‚  Responsibilities:                               â”‚ â”‚  â”‚  â•‘
â•‘  â”‚  â”‚  â”‚  1. Pixel-perfect screen capture                â”‚ â”‚  â”‚  â•‘
â•‘  â”‚  â”‚  â”‚  2. Support full screen + view capture          â”‚ â”‚  â”‚  â•‘
â•‘  â”‚  â”‚  â”‚  3. Save as PNG to temp directory               â”‚ â”‚  â”‚  â•‘
â•‘  â”‚  â”‚  â”‚  4. Auto-cleanup old files                      â”‚ â”‚  â”‚  â•‘
â•‘  â”‚  â”‚  â”‚                                                 â”‚ â”‚  â”‚  â•‘
â•‘  â”‚  â”‚  â”‚  Tool: UIGraphicsImageRenderer                  â”‚ â”‚  â”‚  â•‘
â•‘  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚  â•‘
â•‘  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â•‘
â•‘  â”‚                                                                 â”‚  â•‘
â•‘  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â•‘
â•‘  â”‚  â”‚  GitLabSessionStore                                     â”‚  â”‚  â•‘
â•‘  â”‚  â”‚  - Persist JWT token                                    â”‚  â”‚  â•‘
â•‘  â”‚  â”‚  - Store current username                              â”‚  â”‚  â•‘
â•‘  â”‚  â”‚  - Track expiration                                    â”‚  â”‚  â•‘
â•‘  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â•‘
â•‘  â”‚                                                                 â”‚  â•‘
â•‘  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â•‘
â•‘                                                                         â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

---

## Domain Layer (Data Models & Protocols)

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                  DOMAIN LAYER (Models & Protocols)                          â•‘
â•‘                                                                             â•‘
â•‘  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â•‘
â•‘  â”‚                          DATA MODELS                               â”‚  â•‘
â•‘  â”‚                                                                     â”‚  â•‘
â•‘  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                               â”‚  â•‘
â•‘  â”‚  â”‚  BugReport (Core)              â”‚                               â”‚  â•‘
â•‘  â”‚  â”‚  â€¢ id: String                  â”‚                               â”‚  â•‘
â•‘  â”‚  â”‚  â€¢ timestamp: Date             â”‚                               â”‚  â•‘
â•‘  â”‚  â”‚  â€¢ description: String         â”‚                               â”‚  â•‘
â•‘  â”‚  â”‚  â€¢ priority: BugPriority       â”‚                               â”‚  â•‘
â•‘  â”‚  â”‚  â€¢ category: BugCategory â—„â”€â”€â”€â”€â”€â”¼â”€â”€â”€ **AUTO-SET FROM CRASH**   â”‚  â•‘
â•‘  â”‚  â”‚  â€¢ userActions: [UserAction]   â”‚                               â”‚  â•‘
â•‘  â”‚  â”‚  â€¢ deviceInfo: DeviceInfo      â”‚                               â”‚  â•‘
â•‘  â”‚  â”‚  â€¢ appInfo: AppInfo            â”‚                               â”‚  â•‘
â•‘  â”‚  â”‚  â€¢ memoryInfo: MemoryInfo?     â”‚â—„â”€â”€â”€ **KEY FOR CRASH DATA**   â”‚  â•‘
â•‘  â”‚  â”‚  â€¢ mediaAttachments: [MediaAtt]â”‚                               â”‚  â•‘
â•‘  â”‚  â”‚  â€¢ customData: [String: String]â”‚                               â”‚  â•‘
â•‘  â”‚  â”‚  â€¢ gitLabProject: String?      â”‚                               â”‚  â•‘
â•‘  â”‚  â”‚  â€¢ gitLabCredentials: Creds?   â”‚                               â”‚  â•‘
â•‘  â”‚  â”‚  â€¢ assigneeUsername: String?   â”‚                               â”‚  â•‘
â•‘  â”‚  â”‚  â€¢ issueNumber: Int?           â”‚                               â”‚  â•‘
â•‘  â”‚  â”‚  â€¢ whtype: String              â”‚                               â”‚  â•‘
â•‘  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                               â”‚  â•‘
â•‘  â”‚                                                                     â”‚  â•‘
â•‘  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â•‘
â•‘  â”‚  â”‚  DeviceInfo                    â”‚    â”‚  MemoryInfo          â”‚  â”‚  â•‘
â•‘  â”‚  â”‚  â€¢ deviceModel: String         â”‚    â”‚  â€¢ usedMemory: Int64 â”‚  â”‚  â•‘
â•‘  â”‚  â”‚  â€¢ systemName: String          â”‚    â”‚  â€¢ availableMemory   â”‚  â”‚  â•‘
â•‘  â”‚  â”‚  â€¢ systemVersion: String       â”‚    â”‚    Int64             â”‚  â”‚  â•‘
â•‘  â”‚  â”‚  â€¢ screenSize: CGSize          â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â•‘
â•‘  â”‚  â”‚  â€¢ screenScale: CGFloat        â”‚                               â”‚  â•‘
â•‘  â”‚  â”‚  â€¢ batteryLevel: Float         â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â•‘
â•‘  â”‚  â”‚  â€¢ batteryState: String        â”‚    â”‚  NetworkInfo         â”‚  â”‚  â•‘
â•‘  â”‚  â”‚  â€¢ diskSpace: DiskSpaceInfo    â”‚    â”‚  â€¢ connectionType    â”‚  â”‚  â•‘
â•‘  â”‚  â”‚  â€¢ locale: String              â”‚    â”‚  â€¢ carrierName: Str? â”‚  â”‚  â•‘
â•‘  â”‚  â”‚  â€¢ timezone: String            â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â•‘
â•‘  â”‚  â”‚  â€¢ deviceOrientation: String   â”‚                               â”‚  â•‘
â•‘  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                               â”‚  â•‘
â•‘  â”‚                                                                     â”‚  â•‘
â•‘  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â•‘
â•‘  â”‚  â”‚  MediaAttachment               â”‚    â”‚  AppInfo             â”‚  â”‚  â•‘
â•‘  â”‚  â”‚  â€¢ type: MediaType             â”‚    â”‚  â€¢ bundleIdentifier  â”‚  â”‚  â•‘
â•‘  â”‚  â”‚  â€¢ fileURL: String             â”‚    â”‚  â€¢ version           â”‚  â”‚  â•‘
â•‘  â”‚  â”‚  â€¢ fileName: String            â”‚    â”‚  â€¢ buildNumber       â”‚  â”‚  â•‘
â•‘  â”‚  â”‚  â€¢ timestamp: Date             â”‚    â”‚  â€¢ appName           â”‚  â”‚  â•‘
â•‘  â”‚  â”‚  â€¢ fileSize: Int64?            â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â•‘
â•‘  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                               â”‚  â•‘
â•‘  â”‚                                                                     â”‚  â•‘
â•‘  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                               â”‚  â•‘
â•‘  â”‚  â”‚  UserAction                    â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â•‘
â•‘  â”‚  â”‚  â€¢ id: String                  â”‚    â”‚  ElementInfo         â”‚  â”‚  â•‘
â•‘  â”‚  â”‚  â€¢ timestamp: Date             â”‚    â”‚  â€¢ accessibility ID  â”‚  â”‚  â•‘
â•‘  â”‚  â”‚  â€¢ actionType: ActionType      â”‚    â”‚  â€¢ className         â”‚  â”‚  â•‘
â•‘  â”‚  â”‚  â€¢ screenName: String          â”‚    â”‚  â€¢ text              â”‚  â”‚  â•‘
â•‘  â”‚  â”‚  â€¢ viewControllerClass: String â”‚    â”‚  â€¢ frame             â”‚  â”‚  â•‘
â•‘  â”‚  â”‚  â€¢ elementInfo: ElementInfo?   â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â•‘
â•‘  â”‚  â”‚  â€¢ coordinates: CGPoint?       â”‚                               â”‚  â•‘
â•‘  â”‚  â”‚  â€¢ metadata: [String: String]? â”‚                               â”‚  â•‘
â•‘  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                               â”‚  â•‘
â•‘  â”‚                                                                     â”‚  â•‘
â•‘  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â•‘
â•‘                                                                             â•‘
â•‘  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â•‘
â•‘  â”‚                          PROTOCOLS                                  â”‚  â•‘
â•‘  â”‚                                                                     â”‚  â•‘
â•‘  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â•‘
â•‘  â”‚  â”‚ BugReportProtocol        â”‚   â”‚ ScreenRecordingProtocol      â”‚  â”‚  â•‘
â•‘  â”‚  â”‚ â€¢ submitBugReport()      â”‚   â”‚ â€¢ startRecording()          â”‚  â”‚  â•‘
â•‘  â”‚  â”‚ â€¢ uploadFile()           â”‚   â”‚ â€¢ stopRecording()           â”‚  â”‚  â•‘
â•‘  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚ â€¢ requestPermission()       â”‚  â”‚  â•‘
â•‘  â”‚                                  â”‚ + properties                 â”‚  â”‚  â•‘
â•‘  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â•‘
â•‘  â”‚  â”‚ GitLabAuthProviding      â”‚                                     â”‚  â•‘
â•‘  â”‚  â”‚ â€¢ fetchAuthorization()   â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â•‘
â•‘  â”‚  â”‚ â€¢ authenticateInteract() â”‚   â”‚ ScreenCaptureProtocol        â”‚  â”‚  â•‘
â•‘  â”‚  â”‚ â€¢ hasValidAuthorization()â”‚   â”‚ â€¢ captureScreen()           â”‚  â”‚  â•‘
â•‘  â”‚  â”‚ â€¢ clearCache()           â”‚   â”‚ â€¢ captureView()             â”‚  â”‚  â•‘
â•‘  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚ â€¢ cleanupScreenshots()      â”‚  â”‚  â•‘
â•‘  â”‚                                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â•‘
â•‘  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                     â”‚  â•‘
â•‘  â”‚  â”‚ QCBugPluginDelegate      â”‚                                     â”‚  â•‘
â•‘  â”‚  â”‚ (PUBLIC)                 â”‚                                     â”‚  â•‘
â•‘  â”‚  â”‚ â€¢ bugPluginShouldPresent â”‚                                     â”‚  â•‘
â•‘  â”‚  â”‚ â€¢ didSubmitReport()      â”‚                                     â”‚  â•‘
â•‘  â”‚  â”‚ â€¢ didFailToSubmit()      â”‚                                     â”‚  â•‘
â•‘  â”‚  â”‚ â€¢ didStartRecording()    â”‚                                     â”‚  â•‘
â•‘  â”‚  â”‚ â€¢ didStopRecording()     â”‚                                     â”‚  â•‘
â•‘  â”‚  â”‚ â€¢ didFailRecording()     â”‚                                     â”‚  â•‘
â•‘  â”‚  â”‚ â€¢ didClearSession()      â”‚                                     â”‚  â•‘
â•‘  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                     â”‚  â•‘
â•‘  â”‚                                                                     â”‚  â•‘
â•‘  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â•‘
â•‘                                                                             â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

---

## Data Flow: Bug Report Submission Pipeline

```
START: User taps "Report Bug"
  â”‚
  â”œâ”€ Load SessionState (if available)
  â”‚  â”œâ”€ bugDescription â—„â”€â”€â”€â”€â”€â”€â”
  â”‚  â”œâ”€ priority â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
  â”‚  â”œâ”€ category â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”¼â”€â”€â”€ Persisted from previous form
  â”‚  â”œâ”€ mediaAttachments â—„â”€â”€â”¤  â”‚    in QCBugPluginManager
  â”‚  â””â”€ gitLabProject â—„â”€â”€â”€â”€â”€â”˜  â”‚
  â”‚                             â”‚
  â”œâ”€ Restore Web Form UI        â”‚
  â”‚  â””â”€ Display saved state â”€â”€â”€â”€â”˜
  â”‚
  â”œâ”€ User Interactions
  â”‚  â”œâ”€ Take Screenshot â”€â”€â”
  â”‚  â”‚  â””â”€ Capture â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚  â”‚      Annotate â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
  â”‚  â”‚      Add to Session â”€â”€â”    â”‚ â”‚
  â”‚  â”‚                       â”‚    â”‚ â”‚
  â”‚  â”œâ”€ Record Screen â”€â”€â”    â”‚    â”‚ â”‚
  â”‚  â”‚  â””â”€ Stop â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â” â”‚
  â”‚  â”‚      Create MediaAttachment â”‚ â”‚
  â”‚  â”‚      Add to Session â”€â”€â”€â”€â”   â”‚ â”‚
  â”‚  â”‚                         â”‚   â”‚ â”‚
  â”‚  â””â”€ Fill Form             â”‚   â”‚ â”‚
  â”‚     â”œâ”€ Description â—„â”€â”€â”€â”€â”€â”€â”˜   â”‚ â”‚
  â”‚     â”œâ”€ Priority              â”‚ â”‚
  â”‚     â”œâ”€ Category â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â”‚     â”œâ”€ Assignee (GitLab)     â”‚
  â”‚     â””â”€ Issue # (if linking)  â”‚
  â”‚                              â”‚
  â”œâ”€ Submit Report               â”‚
  â”‚  â”‚                           â”‚
  â”‚  â”œâ”€ Build BugReport â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚  â”‚  â”œâ”€ ID = UUID()                 â”‚
  â”‚  â”‚  â”œâ”€ timestamp = now()           â”‚
  â”‚  â”‚  â”œâ”€ description from form       â”‚
  â”‚  â”‚  â”œâ”€ priority, category from formâ”‚
  â”‚  â”‚  â”œâ”€ userActions (tracked)       â”‚
  â”‚  â”‚  â”œâ”€ deviceInfo (auto-captured)  â”‚
  â”‚  â”‚  â”œâ”€ appInfo (auto-captured)     â”‚
  â”‚  â”‚  â”œâ”€ memoryInfo (auto-captured)  â”‚
  â”‚  â”‚  â”œâ”€ mediaAttachments (from UI)  â”‚
  â”‚  â”‚  â”œâ”€ customData (from app)       â”‚
  â”‚  â”‚  â”œâ”€ gitLabProject (user/config) â”‚
  â”‚  â”‚  â””â”€ gitLabCredentials (if auth) â”‚
  â”‚  â”‚                                 â”‚
  â”‚  â”œâ”€ Fetch GitLab Auth (if needed) â”‚
  â”‚  â”‚  â”œâ”€ Check cache â”€â”€â”€â”          â”‚
  â”‚  â”‚  â”œâ”€ Fetch if stale â”‚          â”‚
  â”‚  â”‚  â””â”€ Generate JWT â”€â”€â”˜          â”‚
  â”‚  â”‚                                â”‚
  â”‚  â”œâ”€ Process Attachments â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â”‚  â”‚  â”œâ”€ For each MediaAttachment
  â”‚  â”‚  â”‚  â”œâ”€ Load file
  â”‚  â”‚  â”‚  â”œâ”€ If Image
  â”‚  â”‚  â”‚  â”‚  â”œâ”€ JPEG compress
  â”‚  â”‚  â”‚  â”‚  â”œâ”€ Scale if needed
  â”‚  â”‚  â”‚  â”‚  â””â”€ Base64 encode â”€â”
  â”‚  â”‚  â”‚  â”‚                     â”œâ”€ Create AttachmentPayload
  â”‚  â”‚  â”‚  â”œâ”€ If Video          â”‚
  â”‚  â”‚  â”‚  â”‚  â”œâ”€ AVAssetExport  â”‚
  â”‚  â”‚  â”‚  â”‚  â”œâ”€ Cascading size â”‚
  â”‚  â”‚  â”‚  â”‚  â””â”€ Base64 encode â”€â”˜
  â”‚  â”‚  â”‚  â””â”€ Add to array
  â”‚  â”‚  â”‚  (parallel processing with DispatchGroup)
  â”‚  â”‚  â”‚
  â”‚  â”‚  â””â”€ Build BugReportPayload
  â”‚  â”‚     â”œâ”€ report: ReportDTO
  â”‚  â”‚     â”œâ”€ attachments: [AttachmentPayload]
  â”‚  â”‚     â”œâ”€ gitlab: GitLabPayload?
  â”‚  â”‚     â””â”€ metadata: MetadataPayload?
  â”‚  â”‚
  â”‚  â”œâ”€ Create HTTP Request
  â”‚  â”‚  â”œâ”€ URL = configuration.webhookURL
  â”‚  â”‚  â”œâ”€ Method = POST
  â”‚  â”‚  â”œâ”€ Body = JSON(BugReportPayload)
  â”‚  â”‚  â”œâ”€ Headers
  â”‚  â”‚  â”‚  â”œâ”€ Content-Type: application/json
  â”‚  â”‚  â”‚  â”œâ”€ Authorization: Bearer {jwt|apikey}
  â”‚  â”‚  â”‚  â”œâ”€ User-Agent: QCBugPlugin/1.0
  â”‚  â”‚  â”‚  â””â”€ X-Request-ID: UUID
  â”‚  â”‚  â”‚
  â”‚  â”‚  â””â”€ POST to webhook
  â”‚  â”‚
  â”‚  â””â”€ Handle Response
  â”‚     â”œâ”€ Success (200)
  â”‚     â”‚  â”œâ”€ Extract reportId from response
  â”‚     â”‚  â”œâ”€ Delegate callback: didSubmitReport(reportId)
  â”‚     â”‚  â”œâ”€ Dismiss form
  â”‚     â”‚  â””â”€ Save session state
  â”‚     â”‚
  â”‚     â”œâ”€ Auth Error (401)
  â”‚     â”‚  â”œâ”€ Clear cache
  â”‚     â”‚  â”œâ”€ Delegate callback: didFailToSubmit(error)
  â”‚     â”‚  â””â”€ Show error message
  â”‚     â”‚
  â”‚     â””â”€ Other Error
  â”‚        â”œâ”€ Log error details
  â”‚        â”œâ”€ Delegate callback: didFailToSubmit(error)
  â”‚        â””â”€ Show error message
  â”‚
  â””â”€ Session Cleanup (Optional)
     â”œâ”€ clearSession() removes all media files
     â”œâ”€ Reset form state
     â””â”€ Keep webhook URL (for next time)
```

---

## Configuration Initialization Flow

```
App Launch
  â”‚
  â”œâ”€ AppDelegate.application(didFinishLaunching:)
  â”‚  â”‚
  â”‚  â”œâ”€ Create window
  â”‚  â”‚  â””â”€ Store as root
  â”‚  â”‚
  â”‚  â”œâ”€ Create QCBugPluginConfig
  â”‚  â”‚  â”œâ”€ webhookURL: String (required)
  â”‚  â”‚  â”œâ”€ apiKey: String? (optional)
  â”‚  â”‚  â”œâ”€ customData: [String: Any] (optional)
  â”‚  â”‚  â”œâ”€ isScreenRecordingEnabled: Bool (default: true)
  â”‚  â”‚  â”œâ”€ enableFloatingButton: Bool (default: false) â—„â”€â”€â”€ DEBUG ONLY
  â”‚  â”‚  â””â”€ gitLabAppConfig: GitLabAppConfig? (optional)
  â”‚  â”‚     â”œâ”€ appId: String
  â”‚  â”‚     â”œâ”€ secret: String
  â”‚  â”‚     â”œâ”€ signingKey: String
  â”‚  â”‚     â”œâ”€ baseURL: URL (default: gitlab.com)
  â”‚  â”‚     â”œâ”€ scopes: [String] (default: ["api"])
  â”‚  â”‚     â”œâ”€ jwtExpiration: TimeInterval (default: 300s)
  â”‚  â”‚     â””â”€ project: String? (optional GitLab project)
  â”‚  â”‚
  â”‚  â””â”€ QCBugPlugin.configure(using: window, configuration: config)
  â”‚     â”‚
  â”‚     â””â”€ â†’ QCBugPluginManager.shared.configure()
  â”‚        â”‚
  â”‚        â”œâ”€ Store config & window
  â”‚        â”‚
  â”‚        â”œâ”€ Initialize Services:
  â”‚        â”‚  â”œâ”€ screenRecorder = ScreenRecordingService()
  â”‚        â”‚  â”œâ”€ screenCapture = ScreenCaptureService()
  â”‚        â”‚  â”œâ”€ gitLabAuthService = GitLabAuthService(config)
  â”‚        â”‚  â””â”€ bugReportService = BugReportAPIService(webhook, api_key)
  â”‚        â”‚
  â”‚        â”œâ”€ Setup Floating UI (if enableFloatingButton)
  â”‚        â”‚  â””â”€ QCFloatingActionButtons â†’ add to window
  â”‚        â”‚
  â”‚        â””â”€ isConfigured = true
  â”‚
  â”œâ”€ Optional: Set custom data
  â”‚  â””â”€ QCBugPlugin.setCustomData(["userId": "123", ...])
  â”‚     â””â”€ Manager.sessionMergedCustomData
  â”‚
  â””â”€ Optional: Set delegate
     â””â”€ QCBugPlugin.setDelegate(self)
        â””â”€ Manager.delegate = self
```

